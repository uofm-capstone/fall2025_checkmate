<% teams_collection = local_assigns[:teams] || @teams %>

<%= bootstrap_form_with model: student, local: true do |f| %>
  <% if student.errors.any? %>
    <div class="alert alert-danger">
      <strong><%= pluralize(student.errors.count, "error") %></strong> prevented this student from being saved:
      <ul class="mb-0">
        <% student.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group">
    <%= f.text_field  :full_name,       label: "Full Name",       required: true, autocomplete: "off" %>
    <%= f.email_field :email,           label: "Email",           required: true, autocomplete: "off" %>
    <%= f.text_field  :github_username, label: "GitHub Username", required: true, autocomplete: "off" %>

    <%# Prefer selecting a real Team when @teams (or locals[:teams]) is provided %>
    <% if teams_collection.present? %>
      <%= f.collection_select :team_id,
            teams_collection, :id, :name,
            { label: "Team", include_blank: "Select a team" },
            class: "form-select" %>
    <% else %>
      <%# Fallback if youâ€™re still storing a plain string column team_name %>
      <%= f.text_field :team_name, label: "Team Name" %>
    <% end %>
  </div>

  <div class="mt-3 d-flex gap-2">
    <%= f.submit student.persisted? ? "Save Changes" : "Create Student", class: "btn btn-primary" %>

    <%# Optional: show a cancel link when not inside a modal %>
    <% if local_assigns[:cancel_path].present? %>
      <%= link_to "Cancel", cancel_path, class: "btn btn-outline-secondary" %>
    <% end %>
  </div>
<% end %>
