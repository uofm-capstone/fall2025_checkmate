<%= form_with(model: team, current_semester: current_semester, local: true) do |form| %>
  <% if team.errors.any? %>
    <div class="alert alert-danger">
      <h4><%= pluralize(team.errors.count, "error") %> prohibited this team from being saved:</h4>
      <ul>
        <% team.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  
  <div class="mb-3">
    <%= form.label :name, class: "form-label" %>
    <%= form.text_field :name, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= form.label :repo_url, class: "form-label" %>
    <%= form.text_field :repo_url, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= form.label :project_board_url, class: "form-label" %>
    <%= form.text_field :project_board_url, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= form.label :client_notes_url, class: "form-label" %>
    <%= form.text_field :client_notes_url, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= form.label :timesheet_url, class: "form-label" %>
    <%= form.text_field :timesheet_url, class: "form-control" %>
  </div>

  <div class="mb-3">
    <%= form.label :github_token, class: "form-label" %>
    <%= form.text_field :github_token, class: "form-control" %>
  </div>

  <% if !team.nil? %>
    <div class="mb-3">
      <table>
        <thead>
          <tr>
            <th>Current Members</th>
          </tr>
        </thead>
        <tbody>
          <% team.students.each do |member| %>
            <tr>
              <td><%= member.name %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <div class="mb-2 fw-semibold">Students</div>
    <div class="border rounded p-2" style="max-height: 240px; overflow: auto;">
      <%= form.collection_check_boxes :student_ids, @students, :id, :full_name do |b| %>
        <div class="form-check">
          <%= b.check_box(class: "form-check-input") %>
          <%= b.label(class: "form-check-label") %>
        </div>
      <% end %>
    </div>

    <div class="text-muted small mb-2">
      Check/uncheck to stage changes. They’re saved only when you click “Update Team.”
    </div>
  <% end %>

  <%= form.submit team.new_record? ? "Create Team" : "Update Team", class: "btn btn-primary" %>
<% end %>
